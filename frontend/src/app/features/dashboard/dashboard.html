<div class="dashboard-container" style="padding: 24px; max-width: 1200px; margin: 0 auto;">
    <div class="header" style="margin-bottom: 24px;">
        <h1 style="font-weight: 700; color: var(--primary-dark);">
            <mat-icon style="vertical-align: middle; margin-right: 8px;">{{ isResident ? 'person_pin' : 'handshake'
                }}</mat-icon>
            {{ userRole === 'Resident' ? 'My Help Requests' : 'Tasks I Am Helping With' }}
        </h1>
        <p style="color: #64748b; font-size: 1.1em; margin-top: 4px;">Manage and track the progress of neighborhood
            activities.</p>
    </div>

    <div class="grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 24px;">
        <mat-card *ngFor="let req of myRequests" class="premium-card">
            <mat-card-header>
                <div mat-card-avatar
                    style="background-color: var(--primary-light); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <mat-icon color="primary">{{ getIcon(req.category) }}</mat-icon>
                </div>
                <mat-card-title>{{ req.title }}</mat-card-title>
                <mat-card-subtitle>{{ req.category }}</mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
                <!-- Visual Status Tracker -->
                <div class="status-tracker">
                    <div class="step" [class.active]="req.status === 'Pending'"
                        [class.completed]="isAfter(req.status, 'Pending')">
                        <div class="dot"></div>
                        <div class="label">Pending</div>
                    </div>
                    <div class="step" [class.active]="req.status === 'Accepted'"
                        [class.completed]="isAfter(req.status, 'Accepted')">
                        <div class="dot"></div>
                        <div class="label">Accepted</div>
                    </div>
                    <div class="step" [class.active]="req.status === 'In-progress'"
                        [class.completed]="isAfter(req.status, 'In-progress')">
                        <div class="dot"></div>
                        <div class="label">Processing</div>
                    </div>
                    <div class="step" [class.active]="req.status === 'Completed'">
                        <div class="dot"></div>
                        <div class="label">Done</div>
                    </div>
                </div>

                <p style="color: #444; margin: 16px 0;">{{ req.description }}</p>

                <div *ngIf="!isResident && req.resident_name"
                    style="font-size: 0.9em; color: #666; display: flex; align-items: center;">
                    <mat-icon style="font-size: 18px; width: 18px; height: 18px; margin-right: 4px;">face</mat-icon>
                    For Resident: {{ req.resident_name }}
                </div>
            </mat-card-content>

            <mat-card-actions align="end" style="padding: 16px;">
                <ng-container *ngIf="userRole === 'Helper'">
                    <button mat-raised-button color="primary" *ngIf="req.status === 'Accepted'"
                        (click)="updateStatus(req, 'In-progress')">
                        <mat-icon>play_arrow</mat-icon> Start Work
                    </button>
                    <button mat-raised-button color="accent" *ngIf="req.status === 'In-progress'"
                        (click)="updateStatus(req, 'Completed')">
                        <mat-icon>check_circle</mat-icon> Complete Task
                    </button>
                </ng-container>
                <button mat-button color="primary" [routerLink]="['/requests', req.id, 'status']">View Details</button>
            </mat-card-actions>
        </mat-card>
    </div>

    <div *ngIf="myRequests.length === 0" class="empty-state" style="text-align: center; padding: 60px 0;">
        <mat-icon style="font-size: 64px; width: 64px; height: 64px; color: #ccc;">inbox</mat-icon>
        <h3 style="color: #999;">No requests found here.</h3>
        <button mat-flat-button color="primary" *ngIf="isResident" routerLink="/requests/new" style="margin-top: 16px;">
            Post Your First Request
        </button>
    </div>
</div>